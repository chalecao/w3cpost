---
title: 浏览器默认超时时间测试

---
<article class="article fmt my-3 parsedText">chrome socket默认最长超时时间是5min，不过这个应该是http keep-alive长连接的默认时间。</article> <article class="article fmt my-3 parsedText">参考代码：[https://cs.chromium.org/chromium/src/net/socket/client\_socket\_pool.cc?sq=package:chromium&targetos=linux&l=28][1]</article> <article class="article fmt my-3 parsedText">


  <img loading="lazy" width="1528" height="1288" class="alignnone size-full wp-image-5688 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/format,webp 1528w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_253/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_647/format,webp 768w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/quality,q_50/resize,m_fill,w_712,h_600/format,webp 712w" sizes="(max-width: 1528px) 100vw, 1528px" />

MacOS 环境下，timeout在各[浏览器](https://www.w3cdoc.com)默认值为（以下[浏览器](https://www.w3cdoc.com)都为当前时间最新版本）

* chrome 72.x XHR为4min， fetch 不限制
* chrome 80.x XHR为5min，fetch 不限制
* safari 12 为8min
* firefox 65 貌似没有超时时间

测试代码

<pre class="xml hljs"><code class="html"><span class="hljs-meta"><!DOCTYPE html></span>
<span class="hljs-tag"><<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>></span>
<span class="hljs-tag"><<span class="hljs-name">head</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">title</span>></span>Document<span class="hljs-tag"></<span class="hljs-name">title</span>></span>
<span class="hljs-tag"></<span class="hljs-name">head</span>></span>
<span class="hljs-tag"><<span class="hljs-name">body</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"queryBtn"</span>></span>query<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">time</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"time"</span>></span><span class="hljs-tag"></<span class="hljs-name">time</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">script</span>></span><span class="javascript">
        <span class="hljs-keyword">const</span> ajax = <span class="hljs-function">(<span class="hljs-params">url = <span class="hljs-string">'/api/timeout'</span></span>) =></span> {
            <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();
            <span class="hljs-comment">//设置xhr请求的超时时间</span>
            xhr.timeout = <span class="hljs-number">60</span> *<span class="hljs-number">5</span>* <span class="hljs-number">1000</span>;
            xhr.responseType = <span class="hljs-string">"text"</span>;
            xhr.open(<span class="hljs-string">'GET'</span>, url, <span class="hljs-literal">true</span>);
            xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
                <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.status == <span class="hljs-number">200</span> || <span class="hljs-keyword">this</span>.status == <span class="hljs-number">304</span>){
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'请求完毕'</span>)
                    <span class="hljs-keyword">if</span>(loopId) {
                        clearInterval(loopId)
                    }
                }
                <span class="hljs-built_in">console</span>.log(e)
            }
            xhr.send()
        }
        <span class="hljs-keyword">const</span> queryBtn = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#queryBtn'</span>)
        <span class="hljs-keyword">const</span> time = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#time'</span>)
        loopId = <span class="hljs-literal">null</span>
        queryBtn.addEventListener(<span class="hljs-string">'click'</span>, (event) => {
            ajax()
            <span class="hljs-keyword">const</span> startTime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()
            loopId = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {
                <span class="hljs-keyword">const</span> s = <span class="hljs-built_in">parseInt</span>((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - startTime) / <span class="hljs-number">1000</span>)
                time.innerHTML = s + <span class="hljs-string">' s'</span>
            }, <span class="hljs-number">500</span>)
        })
    </span><span class="hljs-tag"></<span class="hljs-name">script</span>></span>
<span class="hljs-tag"></<span class="hljs-name">body</span>></span>
<span class="hljs-tag"></<span class="hljs-name">html</span>></span></code></pre>

<pre class="javascript hljs"><code class="javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">var</span> app = express();
<span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>).Server(app);
<span class="hljs-keyword">var</span> bodyParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">'body-parser'</span>);

app.use(bodyParser());
app.use(express.json());
app.use(express.static(__dirname + <span class="hljs-string">''</span>));
app.get(<span class="hljs-string">'/'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{
    res.render(<span class="hljs-string">'index'</span>, {});
    <span class="hljs-comment">// res.send('<h1>Welcome Realtime Server</h1>');</span>
});

app.get(<span class="hljs-string">'/api/timeout'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {
        res.send(<span class="hljs-string">"i don't see a lot of PUT requests anymore"</span>)
    }, <span class="hljs-number">60</span> *<span class="hljs-number">10</span>* <span class="hljs-number">1000</span>)<span class="hljs-comment">// 这里设置服务器的响应时间</span>
});

http.listen(<span class="hljs-number">3004</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>()</span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'http://127.0.0.1:3004'</span>);
});</code></pre>

且在chrome 72.x设置timeout为5min没有用，在4min时已经提示请求失败  
上面这张是chrome 72，中间是chrome 80，下面是Safari，最后是fetch测试


  <img loading="lazy" width="800" height="465" class="alignnone size-full wp-image-5692 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/format,webp 800w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_174/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_446/format,webp 768w" sizes="(max-width: 800px) 100vw, 800px" />


  <img loading="lazy" width="1608" height="684" class="alignnone size-full wp-image-5691 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/format,webp 1608w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_128/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_327/format,webp 768w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/quality,q_50/resize,m_fill,w_800,h_340/format,webp 800w" sizes="(max-width: 1608px) 100vw, 1608px" />


  <img loading="lazy" width="800" height="294" class="alignnone size-full wp-image-5687 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/format,webp 800w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_110/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_282/format,webp 768w" sizes="(max-width: 800px) 100vw, 800px" />


  <img loading="lazy" width="1596" height="578" class="alignnone size-full wp-image-5694 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/format,webp 1596w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_109/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_278/format,webp 768w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/quality,q_50/resize,m_fill,w_800,h_290/format,webp 800w" sizes="(max-width: 1596px) 100vw, 1596px" />
</article>

 [1]: https://cs.chromium.org/chromium/src/net/socket/client_socket_pool.cc?sq=package:chromium&targetos=linux&l=28
