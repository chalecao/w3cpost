---
title: 浏览器默认超时时间测试

---
<article class="article fmt my-3 parsedText">chrome socket默认最长超时时间是5min，不过这个应该是http keep-alive长连接的默认时间。</article> <article class="article fmt my-3 parsedText">参考代码：[https://cs.chromium.org/chromium/src/net/socket/client\_socket\_pool.cc?sq=package:chromium&targetos=linux&l=28][1]</article> <article class="article fmt my-3 parsedText">


  <img loading="lazy" width="1528" height="1288" class="alignnone size-full wp-image-5688 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/format,webp 1528w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_253/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_647/format,webp 768w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d3d6997c.png?x-oss-process=image/quality,q_50/resize,m_fill,w_712,h_600/format,webp 712w" sizes="(max-width: 1528px) 100vw, 1528px" />

MacOS 环境下，timeout在各[浏览器](https://www.w3cdoc.com)默认值为（以下[浏览器](https://www.w3cdoc.com)都为当前时间最新版本）

* chrome 72.x XHR为4min， fetch 不限制
* chrome 80.x XHR为5min，fetch 不限制
* safari 12 为8min
* firefox 65 貌似没有超时时间

测试代码

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <button id="queryBtn">query</button>
    <time id="time"></time>
    <script>
        const ajax = (url = '/api/timeout') => {
            const xhr = new XMLHttpRequest();
            //设置xhr请求的超时时间
            xhr.timeout = 60 *5* 1000;
            xhr.responseType = "text";
            xhr.open('GET', url, true);
            xhr.onload = function(e) {
                if(this.status == 200 || this.status == 304){
                    console.log('请求完毕')
                    if(loopId) {
                        clearInterval(loopId)
                    }
                }
                console.log(e)
            }
            xhr.send()
        }
        const queryBtn = document.querySelector('#queryBtn')
        const time = document.querySelector('#time')
        loopId = null
        queryBtn.addEventListener('click', (event) => {
            ajax()
            const startTime = new Date()
            loopId = setInterval(() => {
                const s = parseInt((new Date() - startTime) / 1000)
                time.innerHTML = s + ' s'
            }, 500)
        })
    </script>
</body>
</html>
```

```
var express = require('express');
var app = express();
var http = require('http').Server(app);
var bodyParser = require('body-parser');

app.use(bodyParser());
app.use(express.json());
app.use(express.static(__dirname + ''));
app.get('/', function(req, res){
    res.render('index', {});
    // res.send('<h1>Welcome Realtime Server</h1>');
});

app.get('/api/timeout', function(req, res){
    setTimeout(() => {
        res.send("i don't see a lot of PUT requests anymore")
    }, 60 *10* 1000)// 这里设置服务器的响应时间
});

http.listen(3004, function(){
    console.log('http://127.0.0.1:3004');
});
```

且在chrome 72.x设置timeout为5min没有用，在4min时已经提示请求失败  
上面这张是chrome 72，中间是chrome 80，下面是Safari，最后是fetch测试


  <img loading="lazy" width="800" height="465" class="alignnone size-full wp-image-5692 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/format,webp 800w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_174/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703de76b2ed.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_446/format,webp 768w" sizes="(max-width: 800px) 100vw, 800px" />


  <img loading="lazy" width="1608" height="684" class="alignnone size-full wp-image-5691 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/format,webp 1608w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_128/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_327/format,webp 768w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703d919fc1b.png?x-oss-process=image/quality,q_50/resize,m_fill,w_800,h_340/format,webp 800w" sizes="(max-width: 1608px) 100vw, 1608px" />


  <img loading="lazy" width="800" height="294" class="alignnone size-full wp-image-5687 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/format,webp 800w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_110/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e703ca15db9e.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_282/format,webp 768w" sizes="(max-width: 800px) 100vw, 800px" />


  <img loading="lazy" width="1596" height="578" class="alignnone size-full wp-image-5694 shadow" src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png" data-src="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/format,webp" alt="" srcset="https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/format,webp 1596w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/quality,q_50/resize,m_fill,w_300,h_109/format,webp 300w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/quality,q_50/resize,m_fill,w_768,h_278/format,webp 768w, https://haomou.oss-cn-beijing.aliyuncs.com/upload/2020/03/img_5e704286a5277.png?x-oss-process=image/quality,q_50/resize,m_fill,w_800,h_290/format,webp 800w" sizes="(max-width: 1596px) 100vw, 1596px" />
</article>

 [1]: https://cs.chromium.org/chromium/src/net/socket/client_socket_pool.cc?sq=package:chromium&targetos=linux&l=28
